# 日志框架

## 1、日志技术的概述

### 1.1、日志

- 生活中的日志： 生活中的日志就好比日记，可以记录你生活的点点滴滴。
- 程序中的日志： 程序中的日志可以用来记录程序运行过程中的信息，并可以进行永久存储。

### 1.2、以前记录日志的方式

```java
Scanner sc = new Scanner(System.in);
System.out.println("请输入一个整数");
String number = sc.nextLine();
try {
int result = Integer.parseInt(number);
System.out.println("输入的数字为" + result);
} catch (NumberFormatException e) {
System.out.println("输入的数字有误，请输入一个整数");
```

### 1.3、输出语句作为日志的弊端

- 信息只能展示在控制台
- 不能将其记录到其他的位置（文件，数据库）
- 想取消记录的信息需要修改代码才可以完成

### 1.4、日志技术具备的优势

- 可以将系统执行的信息选择性的记录到指定的位置（控制台、文件中、数据库中）。
- 可以随时以开关的形式控制是否记录日志，无需修改源代码。

### 1.5、小节

#### 日志技术的具体优势？

|          | **输出语句**               | **日志技术**                         |
| -------- | -------------------------- | ------------------------------------ |
| 输出位置 | 只能是控制台               | 可以将日志信息写入到文件或者数据库中 |
| 取消日志 | 需要修改代码，灵活性比较差 | 不需要修改代码，灵活性比较好         |
| 多线程   | 性能较差                   | 性能较好                             |

## 2、日志技术体系结构

### 2.1、体系结构

![](笔记图片资源包\snipaste20220202_121934.jpg)

- 日志规范：一些接口，提供给日志的实现框架设计的标准。
- 日志框架：牛人或者第三方公司已经做好的日志记录实现代码，后来者直接可以拿去使用。
- 因为对Commons Logging的接口不满意，有人就搞了SLF4J。因为对Log4j的性能不满意，有人就搞了Log back。

### 2.2、小节

#### 日志的规范是什么，常见的有几种形式。

- 日志规范大多是一些接口，提供给实现框架去设计的。
- 常见的规范是：
- Commons Logging
- Simple Logging Facade for Java

#### 日志的实现框架有哪些常见的？

- Log4J
- Log back(我们重点学习的，其他的都大同小异)

## 3、Log back概述

### 3.1、Log back日志框架

- Log back是由log4j创始人设计的另一个开源日志组件，性能比log4j要好

- ```html
  官方网站：https://logback.qos.ch/index.html 
  ```

- Log back是基于slf4j的日志规范实现的框架。

### 3.2、Log back主要分为三个技术模块

####  3.2.1、log back-core

-  log back-core 模块为其他两个模块奠定了基础，必须有。

####  3.2.2、log back-classic

- 它是log4j的一个改良版本，同时它完整实现了slf4j API。

####  3.2.3、log back-access 

- 模块与 Tomcat 和 Jetty 等 Servlet 容器集成，以提供 HTTP 访问日志功能

### 3.3、小节

#### 使用Log back需要使用哪几个模块，各自的作用是什么。

- slf4j-API：日志规范
- log back-core：基础模块。
- log back-classic：它是log4j的一个改良版本，同时它完整实现了slf4j API

## 4、Log back快速入门

需求：导入Log back日志技术到项目中，用于纪录系统的日志信息
分析：

- ①：在项目下新建文件夹lib，导入Log back的相关jar包到该文件夹下，并添加到项目依赖库中去。

- ②：将Log back的核心配置文件logback.xml直接拷贝到src目录下（必须是src下）。

- ③：在代码中获取日志的对象

- ```java
  public static final Logger LOGGER = LoggerFactory.getLogger("类对象");
  ```

- ④：使用日志对象LOGGER调用其方法输出不能的日志信息

#### 小节

##### 使用Log back的开发步骤是怎么样的?

1. 在项目下新建文件夹lib，导入Log back的相关jar包到该文件夹下，并添加到项目库中去。
2. 必须将Log back的核心配置文件logback.xml直接拷贝到src目录下。
3. 在代码中获取日志的对象
4. 使用日志对象输出日志信息

## 5、Log back配置详解-输出位置、格式设置

- Log back日志系统的特性都是通过核心配置文件logback.xml控制的。

### 5.1、Log back日志输出位置、格式设置

- 通过logback.xml 中的<append>标签可以设置输出位置和日志信息的详细格式。
- 通常可以设置2个日志输出位置：一个是控制台、一个是系统文件中

### 5.2、输出到控制台的配置标志

```java
<appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
```

### 5.3、输出到系统文件的配置标志

```java
<appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
```

### 5.4、小节

#### 在核心配置文件Logback.xml中可以配置的日志方向有哪些？

- 输出到控制台的配置标志

```java
<appender name="CONSOLE“ …
```

- 输出到系统文件的配置标志

```java
<appender name=“FILE” …
```

## 6、Log back配置详解-日志级别设置

### 6.1、思考

#### 如果系统上线后只想记录一些错误的日志信息或者不想记录日志了，怎么办？

- 可以通过设置日志的输出级别来控制哪些日志信息输出或者不输出。

### 6.2、日志级别

- 级别程度依次是：TRACE< DEBUG< INFO<WARN<ERROR  ; 默认级别是debug（忽略大小写），对应其方法。
- 作用：用于控制系统中哪些日志级别是可以输出的，只输出级别不低于设定级别的日志信息。
- ALL  和 OFF分别是打开全部日志信息，及关闭全部日志信息。

### 6.3、具体在<root - level="INFO">标签的level属性中设置日志级别。

```java
<root level=“INFO">
<appender-ref ref="CONSOLE"/>
<appender-ref ref="FILE" />
</root>
```

### 6.4、小节

#### 设置日志输出级别的作用是什么？

- 用于控制系统中哪些日志级别是可以输出的。

#### Log back的日志级别是什么样的？

- 级别程度依次是：TRACE< DEBUG< INFO<WARN<ERROR
- 默认级别是debug（忽略大小写），只输出不低于当前级别的日志
- ALL  和 OFF分别是打开全部日志和关闭全部日志