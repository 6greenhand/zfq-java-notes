# 单元测试

## 单元测试概述

### **单元测试**

单元测试就是针对最小的功能单元编写测试代码，Java程序最小的功能单元是方法，因此，单元测试就是针对Java方法的测试，进而检查方法的正确性。

### 目前测试方法是如何进行的，存在什么问题？

- 只有一个main方法，如果一个方法的测试失败了，其他方法测试会受到影响。
- 无法得到测试的结果报告，需要程序员自己去观察测试是否成功。
- 无法实现自动化测试。

![](笔记图片资源包\snipaste20220224_130855.jpg)

### Junit单元测试框架

- JUnit是使用Java语言实现的单元测试框架，它是开源的，Java开发者都应当学习并使用JUnit编写单元测试。
- 此外，几乎所有的IDE工具都集成了JUnit，这样我们就可以直接在IDE中编写并运行JUnit测试，JUnit目前最新版本是5。

### JUnit优点

- JUnit可以灵活的选择执行哪些测试方法，可以一键执行全部测试方法。
-  Junit可以生成全部方法的测试报告。
- 单元测试中的某个方法测试失败了，不会影响其他测试方法的测试。

### 小节

#### Junit单元测试是做什么的？

- 测试类中方法的正确性的。

#### Junit单元测试的优点是什么？

- JUnit可以选择执行哪些测试方法，可以一键执行全部测试方法的测试。
-  JUnit可以生测试报告，如果测试良好则是绿色；如果测试失败，则是红色。
- 单元测试中的某个方法测试失败了，不会影响其他测试方法的测试。

## 单元测试快速入门

### 案例

需求：使用单元测试进行业务方法预期结果、正确性测试的快速入门
分析：

- 将JUnit的jar包导入到项目中

  - IDEA通常整合好了Junit框架，一般不需要导入。

  - 如果IDEA没有整合好，需要自己手工导入如下2个JUnit的jar包到模块

- ![](笔记图片资源包\snipaste20220224_134139.jpg)


- 编写测试方法：该测试方法必须是公共的无参数无返回值的非静态方法。
- 在测试方法上使用@Test注解：标注该方法是一个测试方法
- 在测试方法中完成被测试方法的预期正确性测试。
- 选中测试方法，选择“JUnit运行” ，如果测试良好则是绿色；如果测试失败，则是红色

![](笔记图片资源包\snipaste20220224_134148.jpg)



## Junit单元测试

```java
* 测试分类：
	1. 黑盒测试：不需要写代码，给输入值，看程序是否能够输出期望的值。
	2. 白盒测试：需要写代码的。关注程序具体的执行流程。

* Junit使用：白盒测试
	* 步骤：
		1. 定义一个测试类(测试用例)
			* 建议：
				* 测试类名：被测试的类名Test		CalculatorTest
				* 包名：xxx.xxx.xx.test		cn.itcast.test

		2. 定义测试方法：可以独立运行
			* 建议：
				* 方法名：test测试的方法名		testAdd()  
				* 返回值：void
				* 参数列表：空参

		3. 给方法加@Test
		4. 导入junit依赖环境

	* 判定结果：
		* 红色：失败
		* 绿色：成功
		* 一般我们会使用断言操作来处理结果
			* Assert.assertEquals(期望的结果,运算的结果);

	* 补充：
		* @Before:
			* 修饰的方法会在测试方法之前被自动执行
		* @After:
			* 修饰的方法会在测试方法执行之后自动被执行
```



### 小节

#### JUnit单元测试的实现过程是什么样的？

- 必须导入Junit框架的jar包。
- 定义的测试方法必须是无参数无返回值，且公开的方法。
- 测试方法使用@Test注解标记。

#### JUnit测试某个方法，测试全部方法怎么处理？成功的标志是什么

- 测试某个方法直接右键该方法启动测试。
- 测试全部方法，可以选择类或者模块启动。
- 红色失败，绿色通过。

### 示例

```java
**
   业务方法
 */
public class UserService {
    public String loginName(String loginName , String passWord){
        if("admin".equals(loginName) && "123456".equals(passWord)){
            return "登录成功";
        }else {
            return "用户名或者密码有问题";
        }
    }

    public void selectNames(){
        System.out.println(10/2);
        System.out.println("查询全部用户名称成功~~");
    }
}
-------------------------------------------------------
/**
 * 测试类
 */
public class TestUserService {
    /**
     * 测试方法
     * 注意点：
     * 必须是公开的无返回值的方法
     * 测试方法必须使用@Test注解标记
     */
    @Test
    public void testLoginName()
    {
        UserService userService=new UserService();
        String rs=userService.loginName("admin","123456");

        //怎么进行预期结果的正确性测试  断言
        Assert.assertEquals("您的功能业务可能出现问题！","登录成功",rs);

    }

    @Test
    public void testSectNames(){
        UserService userService=new UserService();
        userService.selectNames();
    }
}    
```

## 单元测试常用注解

### Junit常用注解**(Junit 4.xxxx版本)**

| 注解         | 说明                                                         |
| ------------ | ------------------------------------------------------------ |
| @Test        | 测试方法                                                     |
| @Before      | 用来修饰实例方法，该方法会在每一个测试方法执行之前执行一次。 |
| @After       | 用来修饰实例方法，该方法会在每一个测试方法执行之后执行一次。 |
| @BeforeClass | 用来静态修饰方法，该方法会在所有测试方法之前只执行一次。     |
| @AfterClass  | 用来静态修饰方法，该方法会在所有测试方法之后只执行一次。     |

- 开始执行的方法:初始化资源。
- 执行完之后的方法:释放资源。

```java
@Before
public void before(){
    System.out.println("before方法执行一次");
}
@After
public void after(){
    System.out.println("after方法执行一次");
}
@BeforeClass
public static void beforeClass(){
    System.out.println("beforeClass方法执行一次");
}
@AfterClass
public static void afterClass(){
    System.out.println("afterClass方法执行一次");
}
```

### Junit常用注解**(Junit 5.xxxx版本)**

| 注解        | 说明                                                         |
| ----------- | ------------------------------------------------------------ |
| @Test       | 测试方法                                                     |
| @BeforeEach | 用来修饰实例方法，该方法会在每一个测试方法执行之前执行一次。 |
| @AfterEach  | 用来修饰实例方法，该方法会在每一个测试方法执行之后执行一次。 |
| @BeforeAll  | 用来静态修饰方法，该方法会在所有测试方法之前只执行一次。     |
| @AfterAll   | 用来静态修饰方法，该方法会在所有测试方法之后只执行一次。     |

- 开始执行的方法:初始化资源。
- 执行完之后的方法:释放资源。